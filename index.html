<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Offscript Labs</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;1,400&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCGMUPepRD7eakiRRPtH5J8VnMIOAFqG1E",
            authDomain: "offscript-labs.firebaseapp.com",
            projectId: "offscript-labs",
            storageBucket: "offscript-labs.firebasestorage.app",
            messagingSenderId: "307379820723",
            appId: "1:307379820723:web:4189399269c63c1c7bf8c6",
            measurementId: "G-M2HP1YZJN1"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        // Make auth functions globally available
        window.firebaseAuth = {
            auth,
            provider,
            signInWithPopup,
            GoogleAuthProvider,
            onAuthStateChanged
        };
    </script>
</head>
<body>
    <div class="logo-container">
        <div class="logo">
            <span class="logo-main">Offscript</span>
            <span class="logo-sub">Labs</span>
        </div>
        <button class="login-btn" id="loginBtn">Login</button>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <button class="modal-close" id="closeModal">&times;</button>
            <h2 class="modal-title">Login</h2>
            <div class="login-content">
                <button class="google-signin-btn" id="googleSignInBtn">
                    <svg class="google-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>
                        <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
                        <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/>
                        <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
                    </svg>
                    Sign in with Google
                </button>
                <div class="error-message" id="errorMessage"></div>
            </div>
        </div>
    </div>

    <!-- Success Screen -->
    <div class="success-screen" id="successScreen">
        <div class="success-content">
            <h1 class="success-title">Congrats â€” you've signed in!</h1>
        </div>
    </div>

    <script>
        // Wait for Firebase to be initialized
        window.addEventListener('load', () => {
            const { auth, provider, signInWithPopup, onAuthStateChanged } = window.firebaseAuth;

            // DOM elements
            const loginBtn = document.getElementById('loginBtn');
            const loginModal = document.getElementById('loginModal');
            const closeModal = document.getElementById('closeModal');
            const modalOverlay = loginModal.querySelector('.modal-overlay');
            const googleSignInBtn = document.getElementById('googleSignInBtn');
            const errorMessage = document.getElementById('errorMessage');
            const logoContainer = document.querySelector('.logo-container');
            const successScreen = document.getElementById('successScreen');

            // Check authentication state on page load
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    // User is signed in
                    showSuccessScreen();
                } else {
                    // User is signed out
                    showHomepage();
                }
            });

            // Open modal
            loginBtn.addEventListener('click', () => {
                loginModal.classList.add('modal-open');
                errorMessage.textContent = '';
            });

            // Close modal on X button click
            closeModal.addEventListener('click', () => {
                loginModal.classList.remove('modal-open');
                errorMessage.textContent = '';
            });

            // Close modal on overlay click
            modalOverlay.addEventListener('click', () => {
                loginModal.classList.remove('modal-open');
                errorMessage.textContent = '';
            });

            // Close modal on ESC key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && loginModal.classList.contains('modal-open')) {
                    loginModal.classList.remove('modal-open');
                    errorMessage.textContent = '';
                }
            });

            // Google Sign-In
            googleSignInBtn.addEventListener('click', async () => {
                try {
                    const result = await signInWithPopup(auth, provider);
                    // User signed in successfully
                    console.log('User signed in:', result.user.email);
                    loginModal.classList.remove('modal-open');
                    showSuccessScreen();
                } catch (error) {
                    console.error('Error signing in:', error);
                    errorMessage.textContent = 'Failed to sign in. Please try again.';
                    errorMessage.style.color = '#ef4444';
                }
            });

            // Show success screen
            function showSuccessScreen() {
                logoContainer.style.display = 'none';
                successScreen.classList.add('show');
            }

            // Show homepage
            function showHomepage() {
                logoContainer.style.display = 'flex';
                successScreen.classList.remove('show');
            }
        });
    </script>
</body>
</html> 